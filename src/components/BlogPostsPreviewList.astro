---
import { getCollection } from 'astro:content'
import FormattedDate from '../components/FormattedDate.astro'

interface Props {
    postsLimit: number
}

const { postsLimit } = Astro.props

const posts = (await getCollection('blog'))
    .sort((a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf())
    .slice(0, postsLimit)
---

<section class="md:flex md:flex-col md:items-center md:mx-auto pt-8">
    <div>
        <h2 class="font-synthese m-0 text-4xl mx-8">
            Check out our recent posts
        </h2>
        <p class="mx-8 mt-4">
            Keep up with our local actions, news, and events for a resilient
            Vancouver!
        </p>
    </div>
    <ul class="md:flex md:justify-center m-8 max-w-5xl">
        {
            posts.map((post) => (
                <li class="mx-2">
                    <a href={`/blog/${post.slug}/`}>
                        <img
                            width={720}
                            height={360}
                            src={post.data.heroImage}
                            alt=""
                        />
                        <h4 class="font-synthese mb-2 text-black pt-3 my-0">
                            {post.data.title}
                        </h4>
                        <p class="font-synthese text-sm py-1 text-black">
                            <FormattedDate date={post.data.pubDate} />
                        </p>
                    </a>
                </li>
            ))
        }
    </ul>
</section>
